<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Météo à Villereau (45170)</title>
    <!-- Style pour le fond bleu clair et les éléments de texte centrés -->
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #ADD8E6; /* Couleur de fond bleu clair */
            margin: 0;
            padding: 0;
        }
        .header {
            background-color: #00008B; /* Couleur de fond bleu foncé */
            color: white;
            padding: 20px;
        }
        .weather-info {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- Bandeau bleu foncé en haut de la page -->
    <div class="header">
        <h1>Météo à Villereau (45170)</h1>
        <div id="current-time"></div>
        <div id="current-weather"></div>
    </div>
    <!-- Div pour afficher les prévisions horaires -->
    <div id="hourly-forecast" class="weather-info"></div>

    <!-- Script JavaScript pour récupérer et afficher les données météorologiques -->
    <script>
        // Clé API OpenWeatherMap
        const apiKey = '68622df359e1f37849bae38c5fafd8f6';
        // ID de la ville Villereau (45170)
        const cityId = '6453974';
        // URL pour obtenir les données météorologiques actuelles
        const currentWeatherUrl = `https://api.openweathermap.org/data/2.5/weather?id=${cityId}&appid=${apiKey}&units=metric&lang=fr`;
        // URL pour obtenir les prévisions horaires
        const hourlyForecastUrl = `https://api.openweathermap.org/data/2.5/forecast?id=${cityId}&appid=${apiKey}&units=metric&lang=fr`;

        // Fonction pour récupérer et afficher les données météorologiques actuelles
        async function fetchWeather() {
            try {
                const response = await fetch(currentWeatherUrl);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                displayCurrentWeather(data);
            } catch (error) {
                console.error('Erreur lors de la récupération des données météorologiques:', error);
                document.getElementById('current-weather').innerHTML = '<p>Erreur lors de la récupération des données météorologiques.</p>';
            }
        }

        // Fonction pour récupérer et afficher les prévisions horaires
        async function fetchHourlyForecast() {
            try {
                const response = await fetch(hourlyForecastUrl);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                displayHourlyForecast(data);
            } catch (error) {
                console.error('Erreur lors de la récupération des prévisions horaires:', error);
                document.getElementById('hourly-forecast').innerHTML = '<p>Erreur lors de la récupération des prévisions horaires.</p>';
            }
        }

        // Fonction pour afficher les données météorologiques actuelles
        function displayCurrentWeather(data) {
            const weatherInfo = document.getElementById('current-weather');
            weatherInfo.innerHTML = `
                <p>Température: ${data.main.temp} °C | Humidité: ${data.main.humidity} % | Pression: ${data.main.pressure} hPa | Vent: ${data.wind.speed} m/s ${getWindDirection(data.wind.deg)}</p>
            `;
        }

        // Fonction pour afficher les prévisions horaires
        function displayHourlyForecast(data) {
            const forecastInfo = document.getElementById('hourly-forecast');
            let forecastHTML = '<h2>Prévisions horaires</h2>';
            // Limite à 5 prévisions horaires pour l'affichage
            data.list.slice(0, 5).forEach(forecast => {
                forecastHTML += `
                    <div>
                        <p>${new Date(forecast.dt * 1000).toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })}</p>
                        <p>Température: ${forecast.main.temp} °C</p>
                        <p>Description: ${forecast.weather[0].description}</p>
                    </div>
                `;
            });
            forecastInfo.innerHTML = forecastHTML;
        }

        // Fonction pour afficher l'heure et la date actuelles
        function displayCurrentTime() {
            const now = new Date();
            const currentTime = now.toLocaleString('fr-FR', { dateStyle: 'full', timeStyle: 'short' });
            document.getElementById('current-time').innerHTML = `<p>${currentTime}</p>`;
        }

        // Fonction pour obtenir la direction du vent à partir de l'angle en degrés
        function getWindDirection(deg) {
            const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
            const index = Math.round(deg / 45) % 8;
            return directions[index];
        }

        // Appel des fonctions pour récupérer les données et afficher l'heure actuelle
        fetchWeather();
        fetchHourlyForecast();
        displayCurrentTime();
        // Mise à jour de l'heure et de la date toutes les minutes
        setInterval(displayCurrentTime, 60000);
    </script>
</body>
</html>
