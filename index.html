<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelPlant - Météo</title>
    <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Glacial Indifference', sans-serif;
            margin: 0;
            padding: 0;
        }
        .bandeau {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #000;
            color: #fff;
            padding: 0 20px;
            height: 50px;
        }
        .bandeau-meteo {
            background-color: #00008B;
            color: #fff;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            height: 100px;
        }
        .encart-meteo, .encart-prevision {
            background-color: #fff;
            color: #000;
            padding: 10px;
            margin: 5px;
            flex: 1;
        }
        .titre {
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        .info {
            font-size: 0.9em;
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        #datetime {
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <div class="bandeau">
        <div style="font-weight: bold; font-size: 1.2em;">PixelPlant</div>
        <div id="datetime"></div>
    </div>

    <div class="bandeau-meteo">
        <div class="encart-meteo">
            <div class="titre">Météo actuelle</div>
            <div class="info"><span>Température:</span> <span id="temperature"></span></div>
            <div class="info"><span>Pression atmosphérique:</span> <span id="pressure"></span></div>
            <div class="info"><span>Humidité:</span> <span id="humidity"></span></div>
            <div class="info"><span>Point de rosée:</span> <span id="dew-point"></span></div>
            <div class="info"><span>Couverture nuageuse:</span> <span id="cloudiness"></span></div>
            <div class="info"><span>Vitesse du vent:</span> <span id="wind-speed"></span></div>
            <div class="info"><span>Direction du vent:</span> <span id="wind-direction"></span></div>
            <div class="info"><span>Pluie dans l'heure:</span> <span id="rain"></span></div>
        </div>
    </div>

    <script>
        // Fonction pour convertir la direction du vent en abréviation
        function convertWindDirection(degrees) {
            const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
            const index = Math.round(degrees / 45) % 8;
            return directions[index];
        }

        // Fonction pour calculer le point de rosée
        function calculateDewPoint(temperature, humidity) {
            const a = 17.27;
            const b = 237.7;
            const alpha = ((a * temperature) / (b + temperature)) + Math.log(humidity / 100);
            const dewPoint = (b * alpha) / (a - alpha);
            return dewPoint.toFixed(2); // Renvoie le point de rosée avec 2 décimales
        }

        // Requête à l'API OpenWeatherMap
        const apiKey = "68622df359e1f37849bae38c5fafd8f6";
        const apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=Villereau,FR&units=metric&appid=${apiKey}`;

        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                const temperature = data.main.temp;
                const humidity = data.main.humidity;
                document.getElementById('temperature').textContent = `${temperature} °C`;
                document.getElementById('pressure').textContent = `${data.main.pressure} hPa`;
                document.getElementById('humidity').textContent = `${humidity} %`;
                document.getElementById('dew-point').textContent = `${calculateDewPoint(temperature, humidity)} °C`;
                document.getElementById('cloudiness').textContent = `${data.clouds.all}%`;
                document.getElementById('wind-speed').textContent = `${data.wind.speed} km/h`;
                document.getElementById('wind-direction').textContent = `${convertWindDirection(data.wind.deg)}`;
                if (data.rain && data.rain['1h']) {
                    document.getElementById('rain').textContent = `${data.rain['1h']} mm`;
                } else {
                    document.getElementById('rain').textContent = `Pas de pluie prévue`;
                }
            })
            .catch(error => console.error('Erreur lors de la récupération des données météorologiques :', error));

        // JavaScript pour afficher la date et l'heure
        function displayDateTime() {
            const now = new Date();
            const datetimeElement = document.getElementById('datetime');
            const formattedDate = now.toLocaleDateString('fr-FR');
            const formattedTime = now.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            datetimeElement.textContent = `${formattedTime} - ${formattedDate}`;
        }

        displayDateTime(); // Appel de la fonction pour afficher la date et l'heure actuelles
        setInterval(displayDateTime, 60000); // Mise à jour de la date et de l'heure chaque minute
    </script>
</body>
</html>
